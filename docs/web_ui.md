## Web UI 设计与开发

在 Web UI 开发方面，主要任务是设计不同任务对应的用户交互界面，以及与主函数的交互逻辑。具体而言，Web UI 需要实现以下三个目标：

1. **样本输入**  
   用户输入待检测人员（如学生）的照片、声音与姓名至 UI 界面，UI 将样本信息传递给主函数并给出样本输入的信号。当主函数处理完成后，UI 将反馈信号呈现给用户。

2. **本地视频检测**  
   用户可以选择从本地上传视频，或通过电脑内置的摄像头与麦克风进行录制。UI 将视频传递给主函数进行处理，主函数将处理结果（即到场人员名单和缺勤人员名单）以字典的形式返回给 UI 并输出给用户。

3. **实时检测**  
   基本逻辑与本地视频检测相似，区别在于实时检测需要处理流式输入，并以流式的形式将点到的音频输出到用户界面。这种异步逻辑的处理相对较为复杂。

为了实现这个前端开发任务，我们尝试了两种 Web UI 开发工具：

### 开发工具选择

1. **Element UI（基于 Vue）**  
   由饿了吗团队开发，基于 Vue 的 Element UI 的优势是产品可以直接作为 App 嵌入移动设备使用。然而，它的难点在于需要掌握较多前置知识，并且与主程序的交互较为复杂。

2. **Gradio（Python 库）**  
   Gradio 库可以直接在 Python 中导入，优势是与 Python 程序交互方便，易于上手。缺点是难以将其作为 App 集成到移动设备。最终，为了调试方便，我们团队选择使用 Gradio 作为 UI 开发的工具。

为了便于与主程序进行交互并可以在短期内完成开发任务，我们选择使用 Gradio 作为 Web UI 开发工具。

### Gradio 开发方式

在 Gradio 中，有两种 Web UI 开发方式：

1. **`gr.Interface()`**  
   这种方式通过设置参数来快速开发 UI 页面。它的优势在于功能集成度高，尤其对于流式输入输出的实现较为简单。但其劣势在于难以处理多事件触发的逻辑。

2. **`gr.Blocks()`**  
   这种方式采用块状设计，类似网页开发的方式来进行 UI 开发。它的优势在于灵活性更强，适合处理多事件的触发与监听。缺点是实现较为复杂，且函数的输入输出逻辑需要精心设计。

为了实现 **样本输入**、**本地视频检测** 和 **实时检测** 的复杂逻辑，我们选择使用 `gr.Blocks()` 作为 UI 设计的框架，以便对多个事件进行监听。

### 技术方案

在技术方案方面，首先，确定了 Gradio 的块层次代码框架，通过对各个组件的协调排版构建出整体的网页布局。其次，通过分页将各个任务的监听逻辑进行了较好的区分，降低了逻辑处理的复杂性。最后，通过监测按钮的状态、内置状态的变化以及流式输入的信息，调度相关函数运转，最终将信息反馈给主函数进行处理，并接受返回值输出到用户界面。这样便实现了用户与程序的交互。
